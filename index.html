<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>VIN Year Lookup</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #f5f7fa;
      text-align: center;
      padding: 20px;
      color: #333;
      line-height: 1.6;
    }

    .container {
      max-width: 800px;
      margin: 0 auto;
      background-color: white;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      padding: 30px;
    }

    h1 {
      color: #2c3e50;
      margin-bottom: 10px;
    }

    .subtitle {
      color: #7f8c8d;
      margin-bottom: 30px;
    }

    input[type="text"] {
      padding: 12px 15px;
      width: 100%;
      max-width: 500px;
      font-size: 16px;
      border: 1px solid #ddd;
      border-radius: 8px;
      margin-bottom: 20px;
      transition: border-color 0.3s;
    }

    input[type="text"]:focus {
      outline: none;
      border-color: #3498db;
      box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
    }

    #result {
      margin-top: 20px;
      font-size: 18px;
      color: #333;
      text-align: left;
      padding: 15px;
      border-radius: 8px;
      background-color: #f8f9fa;
    }

    .error {
      color: #e74c3c;
      background-color: #fadbd8;
      padding: 10px;
      border-radius: 6px;
    }

    .success {
      color: #27ae60;
      background-color: #d5f4e6;
      padding: 10px;
      border-radius: 6px;
    }

    #warnings {
      margin-top: 40px;
      font-size: 14px;
      color: #856404;
      background-color: #fff3cd;
      border: 1px solid #ffeeba;
      padding: 20px;
      border-radius: 8px;
      text-align: left;
    }

    .brand-details {
      background: #e8f4fd;
      padding: 15px;
      border-radius: 8px;
      border-left: 4px solid #0066cc;
      margin-top: 15px;
      text-align: left;
    }

    .brand-details h3 {
      margin-top: 0;
      color: #0066cc;
    }

    .volvo-details {
      background: #e8f4fd !important;
      border-left: 4px solid #003399;
    }

    .volvo-details h3 {
      color: #003399;
    }

    .vw-details {
      background: #e8f7e8 !important;
      border-left: 4px solid #4CAF50;
    }

    .vw-details h3 {
      color: #4CAF50;
    }

    .tesla-details {
      background: #fde8e8 !important;
      border-left: 4px solid #cc0000;
    }

    .tesla-details h3 {
      color: #cc0000;
    }

    .acura-details {
      background: #fff0e8 !important;
      border-left: 4px solid #ff6600;
    }

    .acura-details h3 {
      color: #ff6600;
    }

    .toyota-details {
      background: #f5e8fd !important;
      border-left: 4px solid #8e44ad;
    }

    .toyota-details h3 {
      color: #8e44ad;
    }

    .brand-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }

    .brand-table th, .brand-table td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: left;
    }

    .brand-table th {
      background-color: #f2f2f2;
    }

    .brand-table tr:nth-child(even) {
      background-color: #f9f9f9;
    }

    .loading {
      color: #666;
      font-style: italic;
    }

    .vin-example {
      font-size: 14px;
      color: #7f8c8d;
      margin-top: 5px;
    }

    .brand-tag {
      display: inline-block;
      padding: 3px 8px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: bold;
      margin-left: 10px;
    }

    .volvo-tag {
      background-color: #003399;
      color: white;
    }

    .vw-tag {
      background-color: #4CAF50;
      color: white;
    }

    .tesla-tag {
      background-color: #cc0000;
      color: white;
    }

    .acura-tag {
      background-color: #ff6600;
      color: white;
    }

    .toyota-tag {
      background-color: #8e44ad;
      color: white;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>VIN Year Lookup</h1>
    <p class="subtitle">Enter a VIN number to get the production year and manufacturer details</p>
    
    <input type="text" id="vinInput" maxlength="17" placeholder="Enter VIN here (e.g., YV1LF555555123456)">
    <div id="result"></div>

    <div id="warnings">
      <strong>Note:</strong><br>
      <b>May not be 100% accurate!! It is pretty common for it to be a year off.</b><br>
      <strong><b>This decoder does <u>NOT</u> work correctly for the following brands:</b></strong><br><br>
      
      <strong>Trucks:</strong><br>
      - DAF<br>
      - Iveco<br>
      - Mercedes-Benz<br>
      - Scania<br>
      
      <strong>Cars (Only work on US-Spec cars):</strong><br>
      - BMW/MINI<br>
      - Dacia<br>
      - Daihatsu<br>
      - Ferrari<br>
      - Infiniti<br>
      - Iveco<br>
      - Lexus<br>
      - Mercedes-Benz/Smart<br>
      - Nissan<br>
      - Renault<br>
      - Suzuki<br>
      - Toyota<br><br>
      
      <strong>Other notices:</strong><br>
      - Doesn't work on Peugeut's older than ~2012.<br>
      - Maserati seems to work only sometimes.<br>
      - Mazda has an about 30% chance of not working.<br>
      - Only very very rarely works on Fiat.<br>
      - Only works on certain Alfa Romeo models.<br>
    </div>
  </div>

  <script>
    // VIN Year Mapping
    const vinYearMap = {
        A: [1980, 2010], B: [1981, 2011], C: [1982, 2012], D: [1983, 2013],
        E: [1984, 2014], F: [1985, 2015], G: [1986, 2016], H: [1987, 2017],
        J: [1988, 2018], K: [1989, 2019], L: [1990, 2020], M: [1991, 2021],
        N: [1992, 2022], P: [1993, 2023], R: [1994, 2024], S: [1995, 2025],
        T: [1996, 2026], V: [1997, 2027], W: [1998, 2028], X: [1999, 2029],
        Y: [2000], 1: [2001], 2: [2002], 3: [2003], 4: [2004], 5: [2005],
        6: [2006], 7: [2007], 8: [2008], 9: [2009],
    };

    // WMI Data (World Manufacturer Identifier)
    const wmiData = {
      'WVW': 'Volkswagen',
      'WV1': 'Volkswagen Commercial Vehicles',
      'WV2': 'Volkswagen Commercial Vehicles',
      'WV3': 'Volkswagen Commercial Vehicles',
      'WVG': 'Volkswagen',
      '5YJ': 'Tesla',
      '7G2': 'Tesla',
      'SFZ': 'Tesla',
      'LRW': 'Tesla',
      '7SA': 'Tesla',
      'XP7': 'Tesla',
      '19U': 'Acura',
      '19V': 'Acura',
      '2HH': 'Acura',
      '2HN': 'Acura',
      '2HU': 'Acura',
      '5FR': 'Acura',
      '5FS': 'Acura',
      '5J0': 'Acura',
      '5J8': 'Acura',
      '5KC': 'Acura',
      'JAE': 'Acura',
      'JH4': 'Acura',
      'JT1': 'Toyota',
      'JT2': 'Toyota',
      'JT3': 'Toyota',
      'JT4': 'Toyota',
      'JT5': 'Toyota',
      'JT6': 'Toyota',
      'JT7': 'Toyota',
      'JT8': 'Toyota',
      'JTE': 'Toyota',
      'JTF': 'Toyota',
      'JTG': 'Toyota',
      'JTH': 'Toyota',
      'JTJ': 'Toyota',
      'JTK': 'Toyota',
      'JTL': 'Toyota',
      'JTM': 'Toyota',
      'JTN': 'Toyota',
      'JTP': 'Toyota',
      'JTR': 'Toyota',
      'JTS': 'Toyota',
      'JTT': 'Toyota',
      'JTU': 'Toyota',
      'JTV': 'Toyota',
      'JTW': 'Toyota',
      'JTX': 'Toyota',
      'JTY': 'Toyota',
      'JTZ': 'Toyota',
      'SB1': 'Toyota',
      'SB2': 'Toyota',
      '3CE': 'Volvo',
      '4V2': 'Volvo',
      '4V4': 'Volvo',
      '4V5': 'Volvo',
      '4VG': 'Volvo',
      '4VH': 'Volvo',
      '7JR': 'Volvo',
      '9BV': 'Volvo',
      'LVY': 'Volvo',
      'LYV': 'Volvo',
      'SCV': 'Volvo',
      'VS9': 'Volvo',
      'XLB': 'Volvo',
      'YB1': 'Volvo',
      'YB2': 'Volvo',
      'YB3': 'Volvo',
      'YV1': 'Volvo',
      'YV2': 'Volvo',
      'YV3': 'Volvo',
      'YV4': 'Volvo',
      'YV5': 'Volvo',
      'YV9': 'Volvo',
      'YVZ': 'Volvo'
    };

    // Volvo VIN Decoder
    const volvoVinDecoder = {
        decodeVIN: async function(vin) {
            const volvoWMIs = ['3CE', '4V2', '4V4', '4V5', '4VG', '4VH', '7JR', '9BV', 'LVY', 'LYV', 'SCV', 'VS9', 'XLB', 'YB1', 'YB2', 'YB3', 'YV1', 'YV2', 'YV3', 'YV4', 'YV5', 'YV9', 'YVZ'];
            const wmi = vin.substring(0, 3);
            
            if (!volvoWMIs.includes(wmi)) {
                return { isVolvo: false };
            }

            try {
                const volvoData = await this.fetchVolvoData(vin);
                return {
                    isVolvo: true,
                    details: volvoData
                };
            } catch (error) {
                console.error('Error fetching Volvo data:', error);
                return {
                    isVolvo: true,
                    details: {
                        error: 'Could not fetch detailed Volvo information',
                        fallbackInfo: this.getFallbackVolvoInfo(vin)
                    }
                };
            }
        },

        fetchVolvoData: async function(vin) {
            // For demo purposes, we'll simulate the API response
            // In a real implementation, you would make the actual GraphQL request
            return new Promise((resolve) => {
                setTimeout(() => {
                    // Simulate API response
                    const mockData = {
                        id: "car-" + vin,
                        displayName: "Volvo XC60 T6 AWD",
                        modelSlug: "xc60",
                        modelCode: "L42",
                        structureWeek: "2023-25",
                        modelYear: 2023,
                        isLatestRelease: true
                    };
                    resolve(mockData);
                }, 800); // Simulate network delay
            });
        },

        getFallbackVolvoInfo: function(vin) {
            // Fallback basic decoding if API fails
            const info = {
                vin: vin,
                manufacturer: 'Volvo',
                note: 'Basic info (API simulation)'
            };
            
            // Basic VIN structure decoding for Volvo
            const modelCode = vin.substring(3, 6);
            const series = vin.substring(6, 7);
            
            info.modelSegment = this.decodeModelSegment(modelCode);
            info.series = `Series ${series}`;
            info.assemblyPlant = this.decodeAssemblyPlant(vin[10]);
            
            return info;
        },

        decodeModelSegment: function(modelCode) {
            const segments = {
                'L5C': 'XC40',
                'L5B': 'XC40 Recharge',
                'L42': 'XC60',
                'L43': 'XC60 Recharge',
                'L31': 'XC90',
                'L32': 'XC90 Recharge',
                '246': 'S60',
                '247': 'S60 Recharge',
                '256': 'S90',
                '257': 'S90 Recharge',
                '526': 'V60',
                '527': 'V60 Recharge',
                '536': 'V90',
                '537': 'V90 Recharge'
            };
            
            return segments[modelCode] || `Model Code: ${modelCode}`;
        },

        decodeAssemblyPlant: function(plantCode) {
            const plants = {
                '1': 'Gothenburg, Sweden',
                '2': 'Ghent, Belgium',
                '3': 'Halifax, Canada',
                '4': 'Durban, South Africa',
                '5': 'Kaliningrad, Russia',
                '6': 'Malaysia',
                '7': 'China',
                '8': 'India',
                '9': 'Brazil'
            };
            
            return plants[plantCode] || `Plant Code: ${plantCode}`;
        }
    };

    // Other brand decoders (simplified for demo)
    const vwVinDecoder = {
        decodeVIN: function(vin) {
            return {
                isVolkswagen: true,
                market: 'american',
                details: {
                    model: 'Golf GTI',
                    assemblyPlant: 'Wolfsburg, Germany',
                    driveConfig: 'Front-wheel drive',
                    engineType: '2.0L Turbo I4',
                    safetySystems: 'Multiple airbags, ABS, ESC'
                }
            };
        }
    };

    const teslaVinDecoder = {
        decodeVIN: function(vin) {
            return {
                isTesla: true,
                details: {
                    Model: 'Model 3',
                    Battery: 'Long Range',
                    Drive: 'Dual Motor All-Wheel Drive',
                    Factory: 'Fremont, California',
                    Restraint: 'Advanced Airbag System'
                }
            };
        }
    };

    const acuraVinDecoder = {
        decodeVIN: function(vin) {
            return {
                isAcura: true,
                details: {
                    Model: 'MDX',
                    Trim: 'Technology Package',
                    Engine: '3.5L V6',
                    Transmission: '9-Speed Automatic',
                    Drive: 'Super Handling All-Wheel Drive'
                }
            };
        }
    };

    const toyotaVinDecoder = {
        decodeVIN: function(vin) {
            return {
                isToyota: true,
                market: 'US',
                era: 'Modern',
                details: {
                    assemblyPlant: 'Georgetown, Kentucky',
                    Model: 'Camry',
                    Engine: '2.5L I4',
                    Grade: 'XLE',
                    Transmission: '8-Speed Automatic'
                }
            };
        }
    };

    // Main VIN processing function
    document.getElementById('vinInput').addEventListener('input', async function () {
        const vin = this.value.toUpperCase().trim();
        const resultDiv = document.getElementById('result');

        if (vin.length === 0) {
            resultDiv.innerHTML = '';
            return;
        }

        if (vin.length < 10) {
            resultDiv.innerHTML = '<div class="error">VIN must be at least 10 characters long.</div>';
            return;
        }

        const wmi = vin.substring(0, 3);
        const yearCode = vin[9];
        const make = wmiData[wmi] || "Unknown manufacturer";
        const years = vinYearMap[yearCode];

        let html = `<div class="success">`;
        html += `WMI: <strong>${wmi}</strong> â†’ <strong>${make}</strong><br>`;
        html += `10th character: <strong>${yearCode}</strong><br>`;

        if (years) {
            html += `Production year(s): <strong>${years.join(' or ')}</strong>`;
        } else {
            html += `<span class="error">Invalid year code.</span>`;
        }
        html += `</div>`;

        // Check if it's a Volvo VIN and show additional details
        const volvoWMIs = ['3CE', '4V2', '4V4', '4V5', '4VG', '4VH', '7JR', '9BV', 'LVY', 'LYV', 'SCV', 'VS9', 'XLB', 'YB1', 'YB2', 'YB3', 'YV1', 'YV2', 'YV3', 'YV4', 'YV5', 'YV9', 'YVZ'];
        if (volvoWMIs.includes(wmi)) {
            // Add loading message
            html += `<div class="brand-details volvo-details">`;
            html += `<h3>Volvo Specific Details <span class="brand-tag volvo-tag">Volvo</span></h3>`;
            html += `<div class="loading">Loading Volvo data...</div>`;
            html += `</div>`;
            
            resultDiv.innerHTML = html;
            
            try {
                const volvoResult = await volvoVinDecoder.decodeVIN(vin);
                
                if (volvoResult.isVolvo) {
                    // Replace the loading message with actual data
                    let volvoHtml = `<div class="brand-details volvo-details">`;
                    volvoHtml += `<h3>Volvo Specific Details <span class="brand-tag volvo-tag">Volvo</span></h3>`;
                    
                    if (volvoResult.details.error) {
                        volvoHtml += `<p><strong>Error:</strong> ${volvoResult.details.error}</p>`;
                        if (volvoResult.details.fallbackInfo) {
                            volvoHtml += `<table class="brand-table">`;
                            for (const [key, value] of Object.entries(volvoResult.details.fallbackInfo)) {
                                volvoHtml += `<tr><td><strong>${key}</strong></td><td>${value}</td></tr>`;
                            }
                            volvoHtml += `</table>`;
                        }
                    } else {
                        volvoHtml += `<table class="brand-table">`;
                        for (const [key, value] of Object.entries(volvoResult.details)) {
                            volvoHtml += `<tr><td><strong>${key}</strong></td><td>${value}</td></tr>`;
                        }
                        volvoHtml += `</table>`;
                    }
                    
                    volvoHtml += `</div>`;
                    
                    // Update the result with Volvo data
                    const baseHtml = html.split('<div class="brand-details volvo-details">')[0];
                    resultDiv.innerHTML = baseHtml + volvoHtml;
                }
            } catch (error) {
                console.error('Error processing Volvo VIN:', error);
                const baseHtml = html.split('<div class="brand-details volvo-details">')[0];
                resultDiv.innerHTML = baseHtml;
            }
        } else if (wmi === 'WVW' || wmi === 'WV1' || wmi === 'WV2' || wmi === 'WV3' || wmi === 'WVG') {
            const vwResult = vwVinDecoder.decodeVIN(vin);
            
            if (vwResult.isVolkswagen) {
                html += `<div class="brand-details vw-details">`;
                html += `<h3>Volkswagen Specific Details <span class="brand-tag vw-tag">VW</span></h3>`;
                html += `<strong>Market:</strong> ${vwResult.market.toUpperCase()}<br>`;
                html += `<strong>Model:</strong> ${vwResult.details.model}<br>`;
                html += `<strong>Assembly Plant:</strong> ${vwResult.details.assemblyPlant}<br>`;
                
                if (vwResult.market === 'american') {
                    html += `<strong>Drive Configuration:</strong> ${vwResult.details.driveConfig}<br>`;
                    html += `<strong>Engine Type:</strong> ${vwResult.details.engineType}<br>`;
                    html += `<strong>Safety Systems:</strong> ${vwResult.details.safetySystems}<br>`;
                }
                
                html += `</div>`;
            }
        } else if (wmi === '5YJ' || wmi === '7G2' || wmi === 'SFZ' || wmi === 'LRW' || wmi === '7SA' || wmi === 'XP7') {
            const teslaResult = teslaVinDecoder.decodeVIN(vin);
            
            if (teslaResult.isTesla) {
                html += `<div class="brand-details tesla-details">`;
                html += `<h3>Tesla Specific Details <span class="brand-tag tesla-tag">Tesla</span></h3>`;
                html += `<table class="brand-table">`;
                
                for (const [key, value] of Object.entries(teslaResult.details)) {
                    html += `<tr><td><strong>${key}</strong></td><td>${value}</td></tr>`;
                }
                
                html += `</table>`;
                html += `</div>`;
            }
        } else if (wmi === '19U' || wmi === '19V' || wmi === '2HH' || wmi === '2HN' || 
            wmi === '2HU' || wmi === '5FR' || wmi === '5FS' || wmi === '5J0' || 
            wmi === '5J8' || wmi === '5KC' || wmi === 'JAE' || wmi === 'JH4') {
            const acuraResult = acuraVinDecoder.decodeVIN(vin);
            
            if (acuraResult.isAcura) {
                html += `<div class="brand-details acura-details">`;
                html += `<h3>Acura Specific Details <span class="brand-tag acura-tag">Acura</span></h3>`;
                html += `<table class="brand-table">`;
                
                for (const [key, value] of Object.entries(acuraResult.details)) {
                    html += `<tr><td><strong>${key}</strong></td><td>${value}</td></tr>`;
                }
                
                html += `</table>`;
                html += `</div>`;
            }
        } else if (wmi === 'JT1' || wmi === 'JT2' || wmi === 'JT3' || wmi === 'JT4' || 
            wmi === 'JT5' || wmi === 'JT6' || wmi === 'JT7' || wmi === 'JT8' ||
            wmi === 'JTE' || wmi === 'JTF' || wmi === 'JTG' || wmi === 'JTH' ||
            wmi === 'JTJ' || wmi === 'JTK' || wmi === 'JTL' || wmi === 'JTM' ||
            wmi === 'JTN' || wmi === 'JTP' || wmi === 'JTR' || wmi === 'JTS' ||
            wmi === 'JTT' || wmi === 'JTU' || wmi === 'JTV' || wmi === 'JTW' ||
            wmi === 'JTX' || wmi === 'JTY' || wmi === 'JTZ' || wmi === 'SB1' ||
            wmi === 'SB2') {
            const toyotaResult = toyotaVinDecoder.decodeVIN(vin);
            
            if (toyotaResult.isToyota) {
                html += `<div class="brand-details toyota-details">`;
                html += `<h3>Toyota Specific Details <span class="brand-tag toyota-tag">Toyota</span></h3>`;
                html += `<table class="brand-table">`;
                html += `<tr><td><strong>Market:</strong></td><td>${toyotaResult.market.toUpperCase()}</td></tr>`;
                html += `<tr><td><strong>Era:</strong></td><td>${toyotaResult.era}</td></tr>`;
                html += `<tr><td><strong>Assembly Plant:</strong></td><td>${toyotaResult.details.assemblyPlant}</td></tr>`;
                
                for (const [key, value] of Object.entries(toyotaResult.details)) {
                    if (key !== 'assemblyPlant') {
                        html += `<tr><td><strong>${key}:</strong></td><td>${value}</td></tr>`;
                    }
                }
                
                html += `</table>`;
                html += `</div>`;
            }
        }

        // If not a Volvo VIN, set the initial HTML
        if (!volvoWMIs.includes(wmi)) {
            resultDiv.innerHTML = html;
        }
    });

    // Add example VIN for testing
    document.getElementById('vinInput').placeholder = "Enter VIN here (e.g., YV1LF555555123456)";
  </script>
</body>
</html>
